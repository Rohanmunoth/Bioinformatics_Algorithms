def trim(leaderBoard, spectrum, N):
    finalList=[]
    linearScoresList=[]
    linearScores=dict()
    newDict=dict()
    for j in range (len(leaderBoard)):
        peptide= leaderBoard[j]
        linearScores[peptide]=linearMassScore(peptide,spectrum)
        linearScoresList.append(linearScores[peptide])
    linearScoresList=sorted(linearScoresList)
    linearScoresList=linearScoresList[::-1]
    for i in linearScores:
        if (i not in newDict):
            newDict[linearScores[i]]=[]
            newDict[linearScores[i]].append(i)
        else:
            newDict[linearScores[i]].append(i)
    for j in range (N,len(linearScoresList)-1):
        if linearScoresList[j]<linearScoresList[N-1]:
            linearScoresList=linearScoresList[:j]
            break

    for i in linearScoresList:
        finalList.append(newDict[i])
    leaderBoard=[]
    for i in finalList:
        while i!=[]:
            leaderBoard.append(i.pop())        
    return leaderBoard


def linearMassScore(g,spectrum):
    theoreticalSpectrum= circular(g)
    experimentalSpectrum = change(spectrum)
    #print(theoreticalSpectrum)
    #print(experimentalSpectrum)
    count=0
    for i in theoreticalSpectrum:
        for j in experimentalSpectrum:
            if (i==j):
                count+=1
                experimentalSpectrum.remove(j)
                break
    return count


def change(spectrum):
    spectrum=spectrum+' '
    newSpectrum =[]
    m=''
    for i in spectrum: 
        if (i==' '):
            newSpectrum.append(int(m))
            m=''
        else:
            m+=i
    return newSpectrum


def circular(g):
    L=[]
    final=[]
    c=1
    scores=[]
    for i in range (len(g)):
        for j in range (len(g)):
            if (j+c<len(g)+1):
                m=g[j:j+c]
                if (len(m)!=len(g)):
                    final.append(m)
        c+=1
    (final.append(g))
    for i in final:
        scores.append(score(i))
    scores=[0]+scores
    scores=sorted(scores)
    return scores

def score(string):
    scores=0
    mass_values={'G':57,'A':71,'S':87,'P':97,'V':99,'T':101,'C':103,'I':113,'L':113,'N':114,'D':115,'K':128,'Q':128,'E':129,'M':131,'H':137,'F':147,'R':156,'Y': 163,'W': 186}
    for i in string:
        scores+=mass_values[i]
    return scores



c=['CGRLCMYNFGPMGSVDAFMNMEQCNAGTAFIATGCTIPACWRS', 'IFPPFRMMWAQDNKFVRAYCLYRMIFHARDFINIAEDPIVHLP', 'SFNMAADVRNCQLHMCKQSGNGEWVNDRTPKEGAFQGGKIERH', 'DCWQILFHCYNDGGMLWCTYRHTPSPLEICMGWISHPIIFAYW', 'YPLDEDVMAQNICDPMIREKDKIRKDHEHIYGGVIDHDPMHIK', 'IWPILENFREYVCCINWQAQLTYVNTLEATTYHFHIGQAQQME', 'NAVMVPQMWWFVWAGWQDCAKDHMHTLAQCTMKQNRKLDNDGE', 'NQDVMPTVDITIEMVNSVKRWREWSTYTNTGGYIWRWRGLTCG', 'TADTWLTFAGLEHGVGRADHQVAFECSEYEMSAQPHNGLICAM', 'PCPWSSIEPMCAHETQQSVLKDLKRKASVEQRQANPVYEHPCD', 'ATRWDDLRPVQQAYHVIPKPDTPWAESCKCFVAGIKKPEEVYK', 'DWNNFAKRRVVDCANKVHGHLKNYYWMWYFQMFLIGDWAPGSK', 'SSSYRKDAVALDAGDKFNWTLMMREKCFNFGPMWGENEPKLAL', 'IHGCKVTYANYGKAHWVARWKFAHITALEPCTRWCALTVKDNM', 'QDYYKGQRLDLQKKCYNSNNLEPEFSLTLYFYNSWIFQISAYY']
#m='0 71 71 71 97 97 99 99 99 101 101 101 101 103 103 103 103 103 103 103 113 113 113 114 128 128 128 128 129 129 129 129 131 131 137 137 147 147 156 156 156 156 163 163 163 172 174 174 186 194 200 200 202 204 216 218 227 227 227 228 229 230 232 232 232 234 238 240 241 242 244 244 248 248 248 250 255 256 262 264 265 266 271 275 277 285 285 285 292 297 297 299 311 314 319 319 330 331 331 333 335 340 341 343 344 345 347 349 353 356 356 357 359 365 366 368 374 376 376 381 383 388 388 388 391 393 393 395 400 405 412 418 422 424 427 427 428 428 430 438 443 444 459 459 459 464 466 469 470 471 472 473 475 477 479 484 484 487 489 492 494 494 494 496 496 501 503 504 504 521 522 524 525 529 531 541 541 546 555 556 558 558 562 563 567 567 572 572 575 581 587 591 595 597 598 599 602 604 605 606 607 608 622 623 624 626 627 629 635 641 644 649 650 653 656 657 658 658 659 659 666 672 675 678 684 688 690 694 695 698 700 704 704 705 707 715 721 723 726 728 728 736 736 742 742 751 752 754 755 756 756 758 759 762 762 764 771 772 781 781 786 793 797 799 803 803 803 806 807 817 819 821 823 827 835 835 843 845 851 852 852 852 854 856 859 865 868 869 871 882 884 884 887 889 891 892 900 900 902 906 910 916 922 922 922 934 934 934 946 948 949 953 953 955 955 955 955 960 963 969 972 974 979 980 982 983 990 990 993 994 997 999 1000 1008 1019 1026 1033 1035 1037 1047 1047 1047 1047 1050 1051 1054 1056 1058 1061 1063 1063 1075 1078 1083 1083 1093 1096 1096 1100 1103 1103 1108 1110 1111 1116 1116 1116 1118 1121 1127 1130 1136 1137 1148 1149 1150 1150 1155 1160 1162 1164 1164 1166 1178 1182 1182 1191 1199 1211 1211 1216 1217 1217 1219 1221 1221 1222 1224 1226 1230 1231 1231 1233 1235 1240 1240 1245 1245 1247 1252 1262 1265 1265 1281 1283 1290 1291 1293 1296 1310 1311 1318 1320 1322 1324 1325 1327 1330 1331 1338 1343 1344 1344 1345 1346 1346 1348 1348 1353 1355 1358 1361 1378 1378 1393 1394 1394 1397 1398 1409 1412 1414 1415 1419 1421 1421 1426 1428 1443 1446 1447 1447 1449 1449 1449 1449 1456 1459 1459 1473 1474 1475 1475 1477 1481 1486 1491 1492 1497 1501 1510 1515 1518 1518 1518 1527 1529 1540 1544 1548 1550 1552 1557 1575 1575 1578 1578 1580 1580 1584 1587 1587 1588 1588 1599 1600 1600 1605 1605 1610 1621 1621 1628 1638 1639 1641 1645 1649 1649 1651 1655 1657 1658 1674 1677 1678 1681 1683 1691 1703 1704 1708 1711 1713 1715 1719 1724 1729 1734 1736 1737 1740 1751 1752 1754 1756 1758 1762 1762 1768 1773 1774 1780 1784 1788 1791 1803 1805 1805 1807 1814 1814 1822 1825 1832 1837 1839 1840 1850 1852 1855 1865 1869 1877 1882 1885 1885 1886 1887 1889 1899 1901 1902 1906 1910 1918 1919 1919 1920 1928 1931 1934 1936 1943 1948 1953 1953 1956 1969 1981 1985 1988 1988 2002 2002 2005 2011 2014 2016 2016 2017 2018 2019 2032 2032 2037 2038 2047 2048 2056 2057 2059 2073 2076 2082 2082 2084 2084 2099 2103 2104 2105 2116 2117 2119 2125 2133 2139 2145 2147 2147 2150 2150 2151 2174 2174 2176 2179 2179 2181 2185 2187 2190 2196 2204 2206 2213 2213 2232 2233 2238 2242 2244 2245 2246 2252 2263 2277 2278 2278 2280 2280 2282 2282 2284 2303 2307 2309 2316 2336 2337 2341 2343 2346 2351 2353 2355 2361 2369 2371 2373 2377 2381 2381 2381 2381 2383 2391 2402 2408 2413 2440 2440 2444 2449 2452 2452 2454 2456 2464 2466 2472 2475 2482 2484 2484 2486 2490 2509 2509 2510 2510 2527 2533 2536 2543 2555 2555 2557 2565 2569 2569 2577 2577 2578 2580 2585 2587 2591 2608 2611 2613 2615 2637 2638 2640 2640 2646 2666 2668 2673 2676 2683 2684 2688 2690 2691 2692 2696 2704 2705 2708 2711 2714 2714 2737 2737 2741 2769 2771 2774 2774 2787 2791 2799 2804 2805 2809 2811 2819 2820 2832 2835 2840 2840 2840 2840 2840 2843 2845 2854 2870 2875 2877 2884 2888 2911 2912 2918 2933 2936 2938 2943 2946 2948 2948 2953 2960 2969 2978 2982 2985 2987 2995 2996 2999 3006 3035 3039 3049 3049 3056 3058 3061 3064 3067 3072 3074 3081 3081 3085 3088 3098 3107 3123 3125 3132 3136 3152 3159 3162 3167 3178 3180 3184 3185 3186 3192 3196 3198 3214 3226 3228 3233 3235 3237 3237 3263 3264 3281 3283 3289 3295 3299 3299 3306 3313 3315 3329 3334 3336 3336 3340 3341 3343 3361 3392 3400 3402 3407 3412 3412 3418 3430 3432 3437 3439 3444 3446 3462 3464 3469 3489 3499 3503 3529 3531 3533 3533 3535 3540 3547 3559 3563 3568 3568 3574 3591 3592 3602 3602 3626 3630 3636 3639 3660 3662 3663 3687 3687 3691 3692 3694 3705 3724 3727 3729 3731 3733 3765 3786 3788 3795 3795 3800 3807 3818 3819 3820 3830 3830 3834 3862 3887 3887 3901 3908 3921 3923 3933 3935 3942 3948 3956 3958 3959 3990 4004 4018 4034 4036 4036 4043 4051 4057 4061 4062 4085 4105 4115 4133 4135 4160 4164 4164 4186 4188 4190 4206 4208 4218 4263 4289 4289 4289 4289 4291 4292 4301 4309 4353 4391 4392 4402 4418 4419 4429 4445 4454 4456 4505 4521 4528 4530 4547 4557 4574 4582 4629 4633 4634 4677 4684 4685 4710 4732 4762 4785 4790 4813 4847 4861 4888 4918 4948 4950 5017 5017 5051 5051 5154 5173 5180 5283 5336 5439'
m='0 57 57 57 71 71 71 87 99 99 99 99 101 101 103 103 113 113 113 113 113 114 114 115 115 115 128 128 128 128 129 129 131 131 131 131 137 137 137 147 156 160 163 170 172 185 185 186 186 186 194 194 199 202 202 212 216 216 226 227 227 227 229 229 230 230 232 234 236 238 242 243 243 244 246 251 252 257 260 260 264 268 284 284 287 289 297 299 300 300 303 307 314 314 316 317 317 331 331 333 335 340 340 342 343 343 345 345 347 347 349 353 354 357 358 358 359 364 367 367 371 380 383 387 397 402 412 415 416 416 418 424 426 429 430 431 442 445 446 448 450 451 454 454 455 461 462 463 467 470 471 472 473 476 477 480 481 483 486 495 496 498 505 511 516 521 526 528 530 533 539 539 543 543 544 552 552 553 553 567 570 573 574 575 576 578 578 579 579 583 587 592 596 596 601 609 610 610 610 611 614 627 627 636 641 642 643 643 647 647 649 649 653 656 657 666 667 667 674 678 680 684 693 699 700 702 703 706 707 709 710 713 715 718 724 724 726 735 738 738 738 743 756 764 764 764 769 769 770 772 773 774 777 779 794 795 797 797 803 806 807 809 811 812 813 816 819 830 833 837 838 839 839 842 852 856 863 863 872 873 878 887 892 892 893 894 895 896 898 899 900 901 904 909 910 910 910 920 923 926 929 932 934 940 943 944 950 955 955 959 967 986 991 994 997 1000 1002 1002 1005 1006 1007 1007 1008 1009 1010 1012 1023 1024 1024 1024 1027 1029 1033 1037 1038 1042 1043 1054 1055 1057 1058 1071 1073 1081 1081 1086 1090 1104 1110 1115 1118 1119 1121 1122 1123 1125 1126 1130 1136 1137 1137 1138 1139 1139 1140 1141 1142 1144 1170 1180 1180 1180 1183 1186 1187 1188 1189 1189 1194 1219 1223 1226 1232 1234 1236 1237 1239 1239 1241 1243 1245 1246 1249 1250 1252 1254 1254 1257 1258 1259 1267 1288 1290 1293 1302 1307 1311 1314 1316 1317 1317 1322 1327 1340 1342 1345 1347 1350 1351 1352 1355 1359 1364 1370 1371 1373 1374 1374 1380 1385 1385 1386 1387 1389 1406 1416 1418 1421 1421 1431 1440 1440 1448 1453 1455 1456 1469 1472 1473 1473 1473 1477 1479 1479 1483 1484 1485 1486 1487 1488 1497 1501 1502 1505 1518 1520 1533 1536 1545 1549 1553 1553 1557 1558 1566 1572 1575 1582 1585 1586 1586 1586 1601 1606 1607 1608 1610 1616 1616 1616 1616 1634 1635 1649 1657 1658 1664 1664 1665 1666 1667 1670 1685 1685 1686 1691 1700 1703 1704 1717 1717 1719 1720 1723 1729 1729 1730 1731 1737 1747 1763 1771 1771 1780 1782 1785 1788 1793 1794 1801 1801 1804 1813 1816 1816 1818 1822 1828 1830 1832 1835 1837 1842 1843 1845 1850 1850 1860 1895 1900 1901 1902 1906 1907 1910 1915 1916 1917 1923 1929 1932 1938 1944 1947 1949 1952 1953 1953 1956 1956 1957 1958 1963 1974 2000 2013 2020 2023 2028 2029 2031 2031 2034 2036 2036 2037 2039 2043 2045 2052 2057 2061 2071 2078 2080 2084 2088 2089 2096 2112 2114 2128 2128 2134 2138 2139 2142 2144 2146 2149 2149 2149 2158 2159 2168 2174 2180 2183 2185 2192 2209 2213 2217 2225 2243 2249 2252 2256 2257 2259 2262 2263 2263 2266 2269 2270 2273 2274 2281 2284 2287 2296 2305 2311 2313 2324 2344 2360 2365 2369 2371 2372 2376 2376 2377 2378 2380 2382 2383 2388 2395 2403 2410 2412 2418 2428 2429 2431 2455 2460 2473 2473 2475 2479 2481 2482 2489 2491 2496 2497 2506 2508 2509 2525 2526 2527 2530 2544 2559 2563 2565 2566 2568 2594 2595 2601 2604 2604 2609 2610 2610 2612 2619 2623 2624 2639 2640 2664 2666 2667 2667 2672 2674 2675 2692 2709 2711 2722 2723 2724 2725 2726 2729 2735 2738 2738 2741 2753 2755 2765 2787 2795 2795 2805 2806 2811 2824 2827 2837 2840 2842 2844 2852 2852 2853 2855 2866 2866 2868 2872 2898 2908 2912 2923 2923 2924 2943 2951 2952 2952 2955 2956 2967 2968 2971 2971 2980 2981 2981 3022 3025 3026 3027 3037 3038 3039 3042 3054 3069 3071 3080 3082 3084 3095 3098 3102 3118 3136 3138 3140 3141 3152 3155 3169 3172 3173 3175 3182 3183 3202 3211 3215 3219 3239 3243 3251 3266 3268 3268 3270 3276 3278 3282 3283 3286 3301 3303 3311 3314 3338 3339 3368 3371 3374 3379 3383 3385 3396 3398 3402 3405 3407 3429 3442 3453 3462 3467 3473 3476 3485 3486 3499 3502 3508 3511 3513 3520 3530 3533 3565 3568 3570 3590 3598 3598 3601 3601 3614 3617 3621 3623 3636 3647 3655 3669 3694 3705 3716 3724 3727 3729 3745 3750 3754 3762 3765 3784 3792 3807 3816 3844 3849 3853 3855 3858 3865 3878 3879 3910 3915 3921 3929 3952 3954 3978 3981 3981 3986 3992 3994 4041 4052 4081 4081 4082 4095 4107 4109 4112 4123 4140 4180 4194 4210 4210 4211 4212 4226 4268 4283 4297 4323 4325 4339 4341 4341 4412 4426 4428 4440 4453 4454 4525 4527 4557 4557 4568 4628 4655 4656 4688 4759 4784 4787 4858 4915 4986'
print(trim(c,m,5))